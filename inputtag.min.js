!function(t){t.fn.textWidth=function(i,e){var n=t("<span>").hide().appendTo(document.body).text(i||this.val()||this.text()).css({font:e||this.css("font"),whiteSpace:"pre"}),r=n.width();return n.remove(),r},t.fn.autoresize=function(i){return i=t.extend({padding:0,minWidth:0,maxWidth:1e4},i||{}),t(this).on("input",function(){t(this).css("width",Math.min(i.maxWidth,Math.max(i.minWidth,t(this).textWidth()+i.padding)))}).trigger("input"),this},t.fn.inputTag=function(i){return i=t.extend({max:-1,delimiter:",",repeat:!0,onAddItem:function(t){},onChange:function(t){},addItemText:function(t){return"Aperte enter para adicionar <b>"+t+"</b>"}},i||{}),1!=this.length?this.each(function(e,n){t(n).inputTag(i)}):(t.extend(this,{init:function(){var e=t(this),n=this;this.initWrapper(),this.initDropdown(),this.initInput(),e.data("items")&&(this.items=e.data("items").split(",")),""!==e.val()&&e.val().split(i.delimiter).map(function(t){n.addItem(t)})},initWrapper:function(){var e=t(this),n=this;e.hide();var r=e.css(["border","padding","margin","border-radius"]);this.radius=r["border-radius"];var a=e.attr("required");this.required=a;var o="";a&&(o="required"),e.wrap('<div class="main--wrapper"><div class="inputtag--wrapper"></div></div>');var s=e.closest(".inputtag--wrapper"),d=t('<input class="input--clone" type="text" '+o+"/>");s.append(d),s.css(r),s.on("inputtag.change",function(){var t=n.data();e.val(t),i.onChange(t),d.attr("required",n.required&&0==t.length)})},initInput:function(){var i=t(this),e=this.getInput(),n=(i.css("padding-right").replace(/[^-\d\.]/g,""),this),r=this.getDropdown(),a=this.getWrapper(),o=i.attr("placeholder");o&&e.attr("placeholder",o),e.on("keypress",function(i){if(13==i.keyCode)return n.addItem(t(this).val(),!0),!1}),e.on("keyup",function(t){n.textSearch=t.target.value,r.trigger("search",n.textSearch),n.textSearch.length>0?n.showDropdown():n.hideDropdown()}),e.on("keydown",function(t){var i=t.keyCode||t.charCode;if((8==i||46==i)&&""===e.val()){t.preventDefault(),t.stopPropagation();var r=e.prev();r.hasClass("item")&&(e.val(r.text()),r.remove(),n.showDropdown())}}),e.autoresize({padding:0,maxWidth:a.width()})},getInput:function(){return t(this).parent().find(".input--clone")},getWrapper:function(){return t(this).closest(".inputtag--wrapper")},getDropdown:function(){return this.getWrapper().next()},initDropdown:function(){var i=t(this),e=this.getInput(),n=(i.css("padding-right").replace(/[^-\d\.]/g,""),this),r=this.getWrapper();r.after('<div class="inputtag__list--dropdown"><ul></ul></div>'),r.on("click",function(){e.focus()});var a=r.siblings(".inputtag__list--dropdown");a.width(r.outerWidth()-2),a.css("border-color",r.css("border-color")),a.on("click","ul li.item",function(i){n.addItem(t(this).data("text"),!0),n.isShow&&n.hideDropdown()}),a.on("search",function(t){if(n.clearDropdownSearchList(),n.items){var i=n.items.filter(function(t){return t.toLowerCase().indexOf(n.textSearch.toLowerCase())>=0});i.length>0?i.map(function(t){n.addDropdownItem(t)}):n.notFound()}else n.notFound()})},data:function(){return t.map(this.getWrapper().find(".item").toArray(),function(i,e){return t(i).text()})},countItems:function(){return this.getWrapper().find(".item").length},addItem:function(e,n){if(""!==e&&(-1==i.max||this.countItems()<i.max)){var r=this.getInput();if(r.val(""),this.hideDropdown(),!i.repeat&&this.data().find(function(t){return t==e}))return;i.onAddItem(e);var a=this.getWrapper();r.before('<div class="item">'+e+'<span class="remove"><i class="icon"></i></span></div>'),a.find(".remove").on("click",function(i){t(this).parent().remove(),a.trigger("inputtag.change"),r.focus()}),n&&a.trigger("inputtag.change"),r.focus()}},notFound:function(){this.getDropdown().find("ul").append('<li class="item" data-text="'+this.textSearch+'">'+i.addItemText(this.textSearch)+"</li>")},clearDropdownSearchList:function(){var t=this.getDropdown().find("ul li");t.off(),t.remove()},addDropdownItem:function(t){var i=this.getDropdown().find("ul"),e=new RegExp(this.textSearch,"i");i.append('<li class="item" data-text="'+t+'">'+t.replace(e,function(t){return"<b>"+t+"</b>"})+"</li>")},showDropdown:function(){var t=this.getDropdown(),i=this.getWrapper();this.isShow=!0,t.css("display","block"),i.css("border-bottom-left-radius",0),i.css("border-bottom-right-radius",0)},hideDropdown:function(){this.isShow=!1;var t=this.getDropdown(),i=this.getWrapper();t.css("display","none"),i.css("border-bottom-left-radius",this.radius),i.css("border-bottom-right-radius",this.radius)}}),this.init())}}(jQuery);
